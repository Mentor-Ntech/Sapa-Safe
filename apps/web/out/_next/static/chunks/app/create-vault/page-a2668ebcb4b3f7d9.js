(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8654],{21391:function(e,a,t){Promise.resolve().then(t.bind(t,12150))},12150:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return b}});var s=t(13267),n=t(85236),r=t(49205),l=t(71200),i=t(27693),o=t(54108),c=t(11879),d=t(63600),u=t(35880),m=t(42119),f=t(91131),x=t(6670),h=t(74609),p=t(50972),g=t(83138),y=t(45154),j=t(39132),v=t(12751),N=t(39217);function b(){var e,a,t;let b=(0,v.useRouter)(),{address:w,isConnected:k}=(0,l.m)(),{createNewVault:C,refreshVaultData:A,checkVaultCreationStatus:F,isLoading:Z,vaultFactory:E}=(0,r.S2)(),{approveTokensForFactory:M,isApprovingTokens:S,checkTokenAllowance:_}=(0,r.Zn)(),{supportedTokens:B,isLoadingSupportedTokens:D}=(0,r.Cj)(),{addTransaction:R}=(0,r.nC)(),[V,I]=(0,n.useState)(1),[z,T]=(0,n.useState)({token:"",targetAmount:"",totalMonths:"",goal:""}),{data:O}=(0,i.u)({address:(()=>{if(z.token)return({cNGN:"0x4a5b03B8b16122D330306c65e4CA4BC5Dd6511d0",cGHS:"0x295B66bE7714458Af45E6A6Ea142A5358A6cA375",cKES:"0x1E0433C1769271ECcF4CFF9FDdD515eefE6CdF92",cZAR:"0x1e5b44015Ff90610b54000DAad31C89b3284df4d",cXOF:"0xB0FA15e002516d0301884059c0aaC0F0C72b019D"})[z.token]})(),abi:[{inputs:[{name:"account",type:"address"}],name:"balanceOf",outputs:[{name:"",type:"uint256"}],stateMutability:"view",type:"function"}],functionName:"balanceOf",args:w?[w]:void 0,query:{enabled:!!w&&!!z.token}}),[P,G]=(0,n.useState)(!1),Y=Array.isArray(B)?B:[],q=[{value:"1",label:"1 Month",months:1},{value:"2",label:"2 Months",months:2},{value:"3",label:"3 Months",months:3},{value:"4",label:"4 Months",months:4},{value:"5",label:"5 Months",months:5},{value:"6",label:"6 Months",months:6},{value:"12",label:"12 Months",months:12}];if(!k)return(0,s.jsx)(o.n,{children:(0,s.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h1",{className:"sapasafe-heading-1 mb-4",children:"Connect Your Wallet"}),(0,s.jsx)("p",{className:"sapasafe-text text-muted-foreground",children:"Connect your wallet to create a savings vault"})]})})});let H=(e,a)=>{T(t=>({...t,[e]:a}))},Q=e=>{switch(e){case 1:return z.token&&z.targetAmount;case 2:return z.totalMonths;case 3:return z.goal;default:return!1}},K=async()=>{if(!Q(3)){N.Am.error("Please fill in all required fields");return}try{G(!0);let e=BigInt(1e18*parseFloat(z.targetAmount)),a=parseInt(z.totalMonths);if(!({cNGN:"0x4a5b03B8b16122D330306c65e4CA4BC5Dd6511d0",cGHS:"0x295B66bE7714458Af45E6A6Ea142A5358A6cA375",cKES:"0x1E0433C1769271ECcF4CFF9FDdD515eefE6CdF92",cZAR:"0x1e5b44015Ff90610b54000DAad31C89b3284df4d",cXOF:"0xB0FA15e002516d0301884059c0aaC0F0C72b019D"})[z.token])throw Error("Token ".concat(z.token," not supported"));console.log("Creating monthly savings vault...");let t=await C(z.token,e,a,z.goal);console.log("Vault creation result:",t),N.Am.success("Vault creation transaction sent! Check your wallet for approval popup."),R({hash:E.createVaultData||"0x0000000000000000000000000000000000000000000000000000000000000000",type:"create_vault",status:"pending",description:"Created ".concat(z.token," vault"),metadata:{token:z.token,targetAmount:z.targetAmount,totalMonths:z.totalMonths,goal:z.goal}});let s=setInterval(async()=>{await F()&&(clearInterval(s),N.Am.success("Vault created successfully!"),console.log("Vault created, refreshing data..."),await A(),b.push("/vaults"))},2e3);setTimeout(()=>{clearInterval(s),N.Am.info("Transaction may still be processing. Check your vaults page."),b.push("/vaults")},3e4)}catch(e){console.error("Error creating vault:",e),e instanceof Error?e.message.includes("Insufficient token balance")?N.Am.error("Insufficient token balance. Please check your wallet."):e.message.includes("Amount below minimum")?N.Am.error("Amount is below the minimum requirement."):e.message.includes("Token not supported")?N.Am.error("Selected token is not supported."):N.Am.error("Failed to create vault: ".concat(e.message)):N.Am.error("Failed to create vault. Please try again.")}finally{G(!1)}},L=()=>Y.find(e=>e.symbol===z.token),X=()=>q.find(e=>e.value===z.totalMonths);return(0,s.jsx)(o.n,{children:(0,s.jsxs)("div",{className:"container mx-auto px-4 py-8 max-w-2xl",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4 mb-8",children:[(0,s.jsxs)(c.z,{variant:"ghost",size:"sm",onClick:()=>b.back(),className:"sapasafe-btn-outline",children:[(0,s.jsx)(x.Z,{className:"h-4 w-4 mr-2"}),"Back"]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"sapasafe-heading-1",children:"Create New Vault"}),(0,s.jsx)("p",{className:"sapasafe-text text-muted-foreground",children:"Set up your savings goal and lock your funds"})]})]}),(0,s.jsx)("div",{className:"flex items-center justify-between mb-8",children:[1,2,3].map(e=>(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"\n                w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium\n                ".concat(V>=e?"bg-primary text-white":"bg-muted text-muted-foreground","\n              "),children:V>e?(0,s.jsx)(h.Z,{className:"h-4 w-4"}):e}),e<3&&(0,s.jsx)("div",{className:"\n                  w-16 h-0.5 mx-2\n                  ".concat(V>e?"bg-primary":"bg-muted","\n                ")})]},e))}),(0,s.jsxs)(d.Zb,{className:"sapasafe-card",children:[(0,s.jsxs)(d.Ol,{children:[(0,s.jsxs)(d.ll,{className:"sapasafe-heading-3",children:[1===V&&"Choose Currency & Target Amount",2===V&&"Select Savings Duration",3===V&&"Set Your Goal"]}),(0,s.jsxs)(d.SZ,{children:[1===V&&"Select the currency and total amount you want to save. You will pay monthly installments.",2===V&&"Choose how many months you want to save over",3===V&&"Describe your savings goal for motivation"]})]}),(0,s.jsxs)(d.aY,{className:"space-y-6",children:[1===V&&(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(m._,{htmlFor:"token",className:"sapasafe-text-sm font-medium",children:"Currency"}),(0,s.jsxs)(f.Ph,{value:z.token,onValueChange:e=>H("token",e),children:[(0,s.jsx)(f.i4,{className:"sapasafe-input",children:(0,s.jsx)(f.ki,{placeholder:"Select currency"})}),(0,s.jsx)(f.Bw,{children:Y.map(e=>(0,s.jsx)(f.Ql,{value:e.symbol,children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{children:e.logo}),(0,s.jsxs)("span",{children:[e.symbol," - ",e.name]})]})},e.symbol))})]}),z.token&&O&&(0,s.jsxs)("p",{className:"text-sm text-muted-foreground mt-1",children:["Balance: ",Number(O)/1e18," ",z.token]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(m._,{htmlFor:"targetAmount",className:"sapasafe-text-sm font-medium",children:"Target Amount"}),(0,s.jsx)(u.I,{id:"targetAmount",type:"number",placeholder:"Enter total amount to save",value:z.targetAmount,onChange:e=>H("targetAmount",e.target.value),className:"sapasafe-input"}),L()&&(0,s.jsxs)("p",{className:"sapasafe-text-xs text-muted-foreground mt-1",children:["Minimum: ",Number((null===(e=L())||void 0===e?void 0:e.minAmount)||0)/1e18," ",z.token]})]})]}),2===V&&(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(m._,{htmlFor:"totalMonths",className:"sapasafe-text-sm font-medium",children:"Savings Duration"}),(0,s.jsxs)(f.Ph,{value:z.totalMonths,onValueChange:e=>H("totalMonths",e),children:[(0,s.jsx)(f.i4,{className:"sapasafe-input",children:(0,s.jsx)(f.ki,{placeholder:"Select duration"})}),(0,s.jsx)(f.Bw,{children:q.map(e=>(0,s.jsx)(f.Ql,{value:e.value,children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(p.Z,{className:"h-4 w-4"}),(0,s.jsx)("span",{children:e.label})]})},e.value))})]})]}),X()&&(0,s.jsxs)("div",{className:"p-4 bg-muted/30 rounded-lg",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,s.jsx)(p.Z,{className:"h-4 w-4 text-primary"}),(0,s.jsx)("span",{className:"sapasafe-text-sm font-medium",children:"Monthly Savings Plan"})]}),(0,s.jsxs)("p",{className:"sapasafe-text-sm text-muted-foreground",children:["You will save monthly over ",null===(a=X())||void 0===a?void 0:a.months," months. Early withdrawal will incur a 10% penalty."]})]})]}),3===V&&(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(m._,{htmlFor:"goal",className:"sapasafe-text-sm font-medium",children:"Savings Goal"}),(0,s.jsx)(u.I,{id:"goal",placeholder:"e.g., Emergency fund, Vacation, Business capital",value:z.goal,onChange:e=>H("goal",e.target.value),className:"sapasafe-input"})]}),(0,s.jsxs)("div",{className:"p-4 bg-primary/5 rounded-lg border border-primary/20",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,s.jsx)(g.Z,{className:"h-4 w-4 text-primary"}),(0,s.jsx)("span",{className:"sapasafe-text-sm font-medium",children:"Vault Summary"})]}),(0,s.jsxs)("div",{className:"space-y-1 text-sm",children:[(0,s.jsxs)("p",{children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"Currency:"})," ",z.token]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"Target Amount:"})," ",z.targetAmount]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"Duration:"})," ",null===(t=X())||void 0===t?void 0:t.label]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"Goal:"})," ",z.goal]})]})]})]}),(0,s.jsxs)("div",{className:"flex justify-between pt-4",children:[(0,s.jsxs)(c.z,{variant:"outline",onClick:()=>{I(e=>Math.max(e-1,1))},disabled:1===V,className:"sapasafe-btn-outline",children:[(0,s.jsx)(x.Z,{className:"h-4 w-4 mr-2"}),"Back"]}),V<3?(0,s.jsxs)(c.z,{onClick:()=>{Q(V)?I(e=>Math.min(e+1,3)):N.Am.error("Please fill in all required fields")},disabled:!Q(V),className:"sapasafe-btn-primary",children:["Next",(0,s.jsx)(y.Z,{className:"h-4 w-4 ml-2"})]}):(0,s.jsx)(c.z,{onClick:K,disabled:!Q(3)||P||Z,className:"sapasafe-btn-primary",children:P?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Creating..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(j.Z,{className:"h-4 w-4 mr-2"}),"Create Vault"]})})]})]})]})]})})}},54108:function(e,a,t){"use strict";t.d(a,{n:function(){return i}});var s=t(13267),n=t(85236),r=t(73355),l=t(92057);function i(e){let{children:a}=e,[t,i]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{i(!0)},[]),(0,s.jsx)(r.M,{mode:"wait",children:t&&(0,s.jsx)(l.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3,ease:"easeInOut"},children:a})})}},63600:function(e,a,t){"use strict";t.d(a,{Ol:function(){return i},SZ:function(){return c},Zb:function(){return l},aY:function(){return d},ll:function(){return o}});var s=t(13267),n=t(85236),r=t(30733);let l=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,s.jsx)("div",{ref:a,className:(0,r.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...n})});l.displayName="Card";let i=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,s.jsx)("div",{ref:a,className:(0,r.cn)("flex flex-col space-y-1.5 p-6",t),...n})});i.displayName="CardHeader";let o=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,s.jsx)("h3",{ref:a,className:(0,r.cn)("text-2xl font-semibold leading-none tracking-tight",t),...n})});o.displayName="CardTitle";let c=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,s.jsx)("p",{ref:a,className:(0,r.cn)("text-sm text-muted-foreground",t),...n})});c.displayName="CardDescription";let d=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,s.jsx)("div",{ref:a,className:(0,r.cn)("p-6 pt-0",t),...n})});d.displayName="CardContent",n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,s.jsx)("div",{ref:a,className:(0,r.cn)("flex items-center p-6 pt-0",t),...n})}).displayName="CardFooter"},35880:function(e,a,t){"use strict";t.d(a,{I:function(){return l}});var s=t(13267),n=t(85236),r=t(30733);let l=n.forwardRef((e,a)=>{let{className:t,type:n,...l}=e;return(0,s.jsx)("input",{type:n,className:(0,r.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:a,...l})});l.displayName="Input"},42119:function(e,a,t){"use strict";t.d(a,{_:function(){return c}});var s=t(13267),n=t(85236),r=t(54858),l=t(43211),i=t(30733);let o=(0,l.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,s.jsx)(r.f,{ref:a,className:(0,i.cn)(o(),t),...n})});c.displayName=r.f.displayName},91131:function(e,a,t){"use strict";t.d(a,{Bw:function(){return h},Ph:function(){return d},Ql:function(){return p},i4:function(){return m},ki:function(){return u}});var s=t(13267),n=t(85236),r=t(63063),l=t(2015),i=t(13102),o=t(74609),c=t(30733);let d=r.fC;r.ZA;let u=r.B4,m=n.forwardRef((e,a)=>{let{className:t,children:n,...i}=e;return(0,s.jsxs)(r.xz,{ref:a,className:(0,c.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...i,children:[n,(0,s.jsx)(r.JO,{asChild:!0,children:(0,s.jsx)(l.Z,{className:"h-4 w-4 opacity-50"})})]})});m.displayName=r.xz.displayName;let f=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,s.jsx)(r.u_,{ref:a,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",t),...n,children:(0,s.jsx)(i.Z,{className:"h-4 w-4"})})});f.displayName=r.u_.displayName;let x=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,s.jsx)(r.$G,{ref:a,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",t),...n,children:(0,s.jsx)(l.Z,{className:"h-4 w-4"})})});x.displayName=r.$G.displayName;let h=n.forwardRef((e,a)=>{let{className:t,children:n,position:l="popper",...i}=e;return(0,s.jsx)(r.h_,{children:(0,s.jsxs)(r.VY,{ref:a,className:(0,c.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:l,...i,children:[(0,s.jsx)(f,{}),(0,s.jsx)(r.l_,{className:(0,c.cn)("p-1","popper"===l&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:n}),(0,s.jsx)(x,{})]})})});h.displayName=r.VY.displayName,n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,s.jsx)(r.__,{ref:a,className:(0,c.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...n})}).displayName=r.__.displayName;let p=n.forwardRef((e,a)=>{let{className:t,children:n,...l}=e;return(0,s.jsxs)(r.ck,{ref:a,className:(0,c.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...l,children:[(0,s.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(r.wU,{children:(0,s.jsx)(o.Z,{className:"h-4 w-4"})})}),(0,s.jsx)(r.eT,{children:n})]})});p.displayName=r.ck.displayName,n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,s.jsx)(r.Z0,{ref:a,className:(0,c.cn)("-mx-1 my-1 h-px bg-muted",t),...n})}).displayName=r.Z0.displayName},50972:function(e,a,t){"use strict";t.d(a,{Z:function(){return s}});let s=(0,t(76421).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},39132:function(e,a,t){"use strict";t.d(a,{Z:function(){return s}});let s=(0,t(76421).Z)("PiggyBank",[["path",{d:"M19 5c-1.5 0-2.8 1.4-3 2-3.5-1.5-11-.3-11 5 0 1.8 0 3 2 4.5V20h4v-2h3v2h4v-4c1-.5 1.7-1 2-2h2v-4h-2c0-1-.5-1.5-1-2h0V5z",key:"uf6l00"}],["path",{d:"M2 9v1c0 1.1.9 2 2 2h1",key:"nm575m"}],["path",{d:"M16 11h0",key:"k2aug8"}]])},83138:function(e,a,t){"use strict";t.d(a,{Z:function(){return s}});let s=(0,t(76421).Z)("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]])}},function(e){e.O(0,[7150,3108,1042,5371,1474,4473,1834,5682,2020,1744],function(){return e(e.s=21391)}),_N_E=e.O()}]);